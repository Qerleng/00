# port: 7890
# socks-port: 7891
mixed-port: 7890
redir-port: 9797
tproxy-port: 9898


ipv6: false
log-level: silent
find-process-mode: strict
mode: rule
allow-lan: true
bind-address: '*'
# keep-alive-interval: 10
skip-auth-prefixes: 
  - 127.0.0.1/8
  - ::1/128
lan-allowed-ips: 
  - 0.0.0.0/0
  - ::/0
lan-disallowed-ips: 
  - 192.168.0.3/32


profile:
  store-selected: false
  store-fake-ip: false
external-controller: 0.0.0.0:9090 
external-ui: /data/adb/box/clash/dashboard


tun:
  enable: false
  device: utun
  mtu: 9000
  stack: system # gvisor / lwip / system
  auto-detect-interface: true
#  auto-route: true
  strict-route: true
  dns-hijack:
    - any:53
    - tcp://any:53
  inet4-route-address: 
    - 0.0.0.0/1
    - 128.0.0.0/1
  inet6-route-address: 
    - "::/1"
    - "8000::/1"

ntp:
  enable: true
  write-to-system: true
  server: time.*.com
  port: 123
  interval: 30


dns:
  cache-algorithm: arc
  enable: true
  ipv6: true
# prefer-h3: true
  listen: 0.0.0.0:53
  use-hosts: true
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter:
    - '*.lan'
  default-nameserver:
    - 114.114.114.114
    - 8.8.8.8
    - tls://1.12.12.12:853
    - tls://223.5.5.5:853
    - system
  nameserver:
    - 114.114.114.114 # default value
    - 8.8.8.8 # default value
    - tls://223.5.5.5:853 # DNS over TLS
    - https://doh.pub/dns-query # DNS over HTTPS
    - https://dns.alidns.com/dns-query#h3=true # HTTP/3，/ perfer-h3 / DoH 
    - https://mozilla.cloudflare-dns.com/dns-query#DNS&h3=true # HTTP/3
    - dhcp://en0 # dns from dhcp
    - quic://dns.adguard.com:784 # DNS over QUIC
  # - '8.8.8.8#en0' # Compatible design  DNS from dhcp
  nameserver-policy:
#   - 'www.baidu.com': '114.114.114.114'
#   - '+.internal.crop.com': '10.0.0.1'
#   - "geosite:cn,private,apple":
#   - https://doh.pub/dns-query
#   - https://dns.alidns.com/dns-query
#   - "geosite:category-ads-all": rcode://success
#   - "www.baidu.com,+.google.cn": [223.5.5.5, https://dns.alidns.com/dns-query]
#   - "rule-set:global,dns": 8.8.8.8
# 且 behavior 必须为 domain/classical，当为 classical 时仅会生效域名类规则
